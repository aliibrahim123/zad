var v=Object.defineProperty;var d=(m,t)=>v(m,"name",{value:t,configurable:!0});import{Component as p,create as o,registry as y}from'./libs.js';import{L as a}from"./chunks/node-CEhKUo8A.js";import{setupStyle as c,defaultSettings as u,saveSettings as l,sendRequest as S}from'./base.js';const f={settings:{node:new a("neo:template",{id:"settings"},[new a("div",{id:"main-section",class:["section"]},[new a("div",{id:"title"},["إعدادات"],{"neocomp:id":81370948}),new a("div",{id:"sections-grid"},[new a("div",{id:"style-button"},["مظهر"],{"neocomp:id":41825668}),new a("div",{id:"storage-button"},["تخزين"],{"neocomp:id":5253285})],{"neocomp:id":88945487})],{"neocomp:id":5947222}),new a("div",{id:"style-section",class:["section"]},[new a("div",{class:["mini-title"]},["مظهر"],{"neocomp:id":82128642}),new a("div",{id:"adjust-font",class:["hide"]},[new a("span",{},["@(fontSize){String(fontSize).padStart(4, '0')}"],{"neocomp:id":4197624}),new a("input",{type:"range",min:"0.2",max:"5",step:"0.01"},[],{"neocomp:id":99674393})],{"neocomp:id":90203478})],{"neocomp:id":7501274}),new a("div",{id:"storage-section",class:["section"]},[new a("div",{class:["mini-title"]},["تخزين"],{"neocomp:id":7099790})],{"neocomp:id":49962289})],{"neocomp:id":23141520}),actions:[{type:"ref",target:5947222,name:"section-main"},{type:"on",target:41825668,events:["click"],fn:new Function("comp","el","event","router.go('#style')")},{type:"on",target:5253285,events:["click"],fn:new Function("comp","el","event","router.go('#storage')")},{type:"ref",target:7501274,name:"section-style"},{type:"ref",target:90203478,name:"adjust-font"},{type:"attr",target:4197624,attr:"text",parts:["",{isExp:!0,fn:new Function("comp","el","fontSize","return String(fontSize).padStart(4, '0')"),dynamics:["fontSize"],statics:[]}],staticProps:[],dynamicProps:[]},{type:"attr",target:99674393,attr:"value",parts:["",{isExp:!1,prop:"fontSize",static:!0}],staticProps:[],dynamicProps:[]},{type:"on",target:99674393,events:["input"],fn:new Function("comp","el","event","comp.updateFont(el.valueAsNumber)")},{type:"on",target:99674393,events:["change"],fn:new Function("comp","el","event","comp.saveSettings()")},{type:"ref",target:49962289,name:"section-storage"}]}};class w extends p{static{d(this,"SettingsPage")}static defaults={...p.defaults,view:{template:f.settings,insertMode:"into",into:"#inner-container"},store:{addUndefined:!0}};init(){this.set("fontSize",settings.style.core.fontSize),this.set("showFontAdjust",!1),this.initDom();const t=this.getSection(location.hash.slice(1));t.classList.add("current"),this.store.add("lastSection",{value:t}),this.addStyleSection(),this.addStorageSection(),this.fireInit()}async onRoute(t){const e=this.get("lastSection"),s=this.getSection(t.hash.slice(1)),i=e.clientWidth;e.classList.remove("current"),s.classList.add("current"),this.set("lastSection",s);const n=settings.style.core.animationSpeed;if(n){const r=t.hash==="";s.animate({transform:[`translateX(${i*(r?1:-1)}px)`,""]},{duration:350*n}),e.classList.add("exiting"),await e.animate({transform:["",`translateX(${i*(r?-1:1)}px)`]},{duration:350*n}).finished,e.classList.remove("exiting")}}getSection(t){return this.refs[`section-${t===""?"main":t}`][0]}addStyleSection(){this.addHeader("style","عام"),this.addButton("style","عدل حجم الخط",this.adjustFont.bind(this)),this.addSlider("style","حجم العناوين",{min:.5,max:1.5,step:.01},t("core","titleSize")),this.addOptions("style","التصميم",[{name:"صفحة ورقية",value:"full-page"},{name:"صفحة عائمة",value:"overlay"}],t("base","layout",!1)),this.addSlider("style","سرعة التحريك",{min:0,max:2.5,step:.01},t("core","animationSpeed")),this.addHeader("style","خلفية"),this.addOptions("style","ملأ الخلفية",[{name:"ملأ",value:"fill"},{name:"ملائم",value:"fit"},{name:"قص",value:"crop"}],t("base","backFill",!1)),this.addOptions("style","جودة الخلفيات",[{name:"منخفضة",value:"low"},{name:"متوسطة",value:"meduim"},{name:"مرتفعة",value:"high"}],t("core","backRes")),this.addOptions("style","خلفية الصفحة",[{name:"ورقة",value:"random"},{name:"شفاف",value:"transparent"},{name:"ضبابي",value:"blur"}],t("base","overlayBack",!1)),this.addSlider("style","شفافية خلفية الصفحة",{min:0,max:1.5,step:.01},t("base","overlayTransMod")),this.addHeader("style","هوامش"),this.addSlider("style","حجم الهامش الداخلي",{min:.25,max:10,step:.01},t("base","padding")),this.addSlider("style","حجم الهامش الخارجي",{min:.25,max:5,step:.01},t("base","margin")),this.addSlider("style","حجم الهامش الخارجي الأفقي",{min:.25,max:3,step:.01},t("base","marginX")),this.addHeader("style","أخرى"),this.addSlider("style","عمق الأسود",{min:.05,max:1.5,step:.01},t("base","blackMod")),this.addSlider("style","حجم الحدود",{min:.25,max:3,step:.01},t("core","borderSize")),this.addSlider("style","حجم المسبحة",{min:.25,max:3,step:.01},t("core","masbahaSize"));function t(e,s,i=!0){return{getter:d(()=>settings.style[e][s],"getter"),setter(n){settings.style[e][s]=n,settings.overwritten.style[e][s]=n,c(i)},reset(){u.style[e][s],settings.style[e][s]=u.style[e][s],delete settings.overwritten.style[e][s],l(),c(i)}}}d(t,"handlerFor")}addStorageSection(){this.addButton("storage","حذف المسبحات",()=>localStorage.removeItem("masabahat")),this.addButton("storage","حذف سجل البحث",()=>localStorage.removeItem("search-history")),this.addButton("storage","حذف المفضلة",()=>localStorage.removeItem("favorites")),this.addButton("storage","حذف التنزيلات",()=>{S({type:"cache",action:"delete-all"}),localStorage.removeItem("zad-installed-packs")}),this.addButton("storage","إدارة التنزيلات",()=>router.go("download.html"))}addHeader(t,e){this.refs[`section-${t}`][0].append(o("div",".header",e))}addSlider(t,e,s,i){const n=o("input",".unit-slider",{type:"range",attrs:s,value:String(i.getter()),events:{input(){i.setter(n.valueAsNumber)},change:d(()=>l(),"change")}}),r=o("div",".unit",o("span",".unit-name",e),n,o("button",".unit-reset","اعادة التعيين",{events:{click:d(()=>{i.reset(),n.value=String(i.getter()),l()},"click")}}));this.refs[`section-${t}`][0].append(r)}addOptions(t,e,s,i){const n=o("select",".unit-select",s.map(({name:g,value:h})=>o("option",{value:h},g)),{events:{change:d(()=>{i.setter(n.value),l()},"change")}},{value:i.getter()}),r=o("div",".unit",o("span",".unit-name",e),n);this.refs[`section-${t}`][0].append(r)}addButton(t,e,s){this.refs[`section-${t}`][0].append(o("div",".unit",".unit-button",e,{events:{click:d(()=>s(),"click")}}))}adjustFont(){const t=!this.get("showFontAdjust"),e=settings.style.core.animationSpeed,s=this.refs["adjust-font"][0];if(this.set("showFontAdjust",t),!e)return s.classList.toggle("hide",!t);s.classList.remove("hide"),s.animate({opacity:t?[0,1]:[1,0]},{duration:400*e}).finished.then(()=>{t||s.classList.add("hide")})}updateFont(t){settings.style.core.fontSize=t,settings.overwritten.style.core.fontSize=t,this.set("fontSize",t),c(!0)}saveSettings(){l()}}y.add("settings",w);
