var h=Object.defineProperty;var d=(c,e)=>h(c,"name",{value:e,configurable:!0});import{Component as u,create as o,registry as y}from'./libs.js';import{L as s}from"./chunks/node-BKieyWgd.js";import{setupStyle as m,defaultSettings as g,saveSettings as r,sendRequest as S}from'./base.js';const f={settings:{node:new s("neo:template",{id:"settings"},[new s("div",{id:"main-section",class:["section"]},[new s("div",{id:"title"},["إعدادات"],{"neocomp:id":47792807}),new s("div",{id:"sections-grid"},[new s("div",{id:"style-button"},["مظهر"],{"neocomp:id":70560483}),new s("div",{id:"storage-button"},["تخزين"],{"neocomp:id":75015270}),new s("div",{id:"timing-button"},["توقيت"],{"neocomp:id":59955811})],{"neocomp:id":60648138})],{"neocomp:id":46140642}),new s("div",{id:"style-section",class:["section"]},[new s("div",{class:["mini-title"]},["مظهر"],{"neocomp:id":35309391}),new s("div",{id:"adjust-font",class:["hide"]},[new s("span",{},["@(fontSize){String(fontSize).padStart(4, '0')}"],{"neocomp:id":96372795}),new s("input",{type:"range",min:"0.2",max:"5",step:"0.01"},[],{"neocomp:id":81009226})],{"neocomp:id":35620876})],{"neocomp:id":63523006}),new s("div",{id:"storage-section",class:["section"]},[new s("div",{class:["mini-title"]},["تخزين"],{"neocomp:id":60755105})],{"neocomp:id":85878299}),new s("div",{id:"timing-section",class:["section"]},[new s("div",{class:["mini-title"]},["توقيت"],{"neocomp:id":47818936})],{"neocomp:id":99891099})],{"neocomp:id":24813244}),actions:[{type:"ref",target:46140642,name:"section-main"},{type:"on",target:70560483,events:["click"],fn:new Function("comp","el","event","router.go('#style')")},{type:"on",target:75015270,events:["click"],fn:new Function("comp","el","event","router.go('#storage')")},{type:"on",target:59955811,events:["click"],fn:new Function("comp","el","event","router.go('#timing')")},{type:"ref",target:63523006,name:"section-style"},{type:"ref",target:35620876,name:"adjust-font"},{type:"attr",target:96372795,attr:"text",template:["",{isExp:!0,fn:new Function("comp","el","fontSize","return String(fontSize).padStart(4, '0')"),dynamics:["fontSize"],statics:[]}],staticProps:[],dynamicProps:[]},{type:"attr",target:81009226,attr:"value",template:["",{isExp:!1,prop:"fontSize",static:!0}],staticProps:[],dynamicProps:[]},{type:"on",target:81009226,events:["input"],fn:new Function("comp","el","event","comp.updateFont(el.valueAsNumber)")},{type:"on",target:81009226,events:["change"],fn:new Function("comp","el","event","comp.saveSettings()")},{type:"ref",target:85878299,name:"section-storage"},{type:"ref",target:99891099,name:"section-timing"}]}};class w extends u{static{d(this,"SettingsPage")}static defaults={...u.defaults,view:{template:f.settings,insertMode:"into",into:"#inner-container"},store:{addUndefined:!0}};styleGroup=this.signal("styleGroup");init(){this.set("fontSize",settings.style.core.fontSize),this.set("showFontAdjust",!1),this.styleGroup=this.signal("styleGroup","tools"),this.initDom();const e=this.getSection(location.hash.slice(1));e.classList.add("current"),this.store.add("lastSection",{value:e}),this.addStyleSection(),this.addStorageSection(),this.addTimingSection(),this.fireInit()}async onRoute(e){const t=this.get("lastSection"),n=this.getSection(e.hash.slice(1)),i=t.clientWidth;t.classList.remove("current"),n.classList.add("current"),this.set("lastSection",n);const a=settings.style.core.animationSpeed;if(a){const l=e.hash==="";n.animate({transform:[`translateX(${i*(l?1:-1)}px)`,""]},{duration:350*a}),t.classList.add("exiting"),await t.animate({transform:["",`translateX(${i*(l?-1:1)}px)`]},{duration:350*a}).finished,t.classList.remove("exiting")}}getSection(e){return this.refs[`section-${e===""?"main":e}`][0]}addStyleSection(){this.addHeader("style","عام"),this.addButton("style","عدل حجم الخط",this.adjustFont.bind(this)),this.addSlider("style","حجم العناوين",{min:.5,max:1.5,step:.01},e("core","titleSize")),this.addOptions("style","التصميم",[{name:"صفحة ورقية",value:"full-page"},{name:"صفحة عائمة",value:"overlay"}],e("base","layout",!1)),this.addSlider("style","سرعة التحريك",{min:0,max:2.5,step:.01},e("core","animationSpeed")),this.addHeader("style","خلفية"),this.addOptions("style","ملأ الخلفية",[{name:"ملأ",value:"fill"},{name:"ملائم",value:"fit"},{name:"قص",value:"crop"}],e("base","backFill",!1)),this.addOptions("style","جودة الخلفيات",[{name:"منخفضة",value:"low"},{name:"متوسطة",value:"meduim"},{name:"مرتفعة",value:"high"}],e("core","backRes")),this.addOptions("style","خلفية الصفحة",[{name:"ورقة",value:"random"},{name:"شفاف",value:"transparent"},{name:"ضبابي",value:"blur"}],e("base","overlayBack",!1)),this.addSlider("style","شفافية خلفية الصفحة",{min:0,max:1.5,step:.01},e("base","overlayTransMod")),this.addHeader("style","هوامش"),this.addSlider("style","حجم الهامش الداخلي",{min:.25,max:10,step:.01},e("base","padding")),this.addSlider("style","حجم الهامش الخارجي",{min:.25,max:5,step:.01},e("base","margin")),this.addSlider("style","حجم الهامش الخارجي الأفقي",{min:.25,max:3,step:.01},e("base","marginX")),this.addHeader("style","أخرى"),this.addSlider("style","عمق الأسود",{min:.05,max:1.5,step:.01},e("base","blackMod")),this.addSlider("style","حجم الحدود",{min:.25,max:3,step:.01},e("core","borderSize")),this.addSlider("style","حجم المسبحة",{min:.25,max:3,step:.01},e("core","masbahaSize"));function e(t,n,i=!0){return{getter:d(()=>settings.style[t][n],"getter"),setter(a){settings.style[t][n]=a,settings.overwritten.style[t][n]=a,m(i)},reset(){settings.style[t][n]=g.style[t][n],delete settings.overwritten.style[t][n],r(),m(i)}}}d(e,"handlerFor")}addStorageSection(){this.addButton("storage","حذف المسبحات",()=>localStorage.removeItem("masabahat")),this.addButton("storage","حذف سجل البحث",()=>localStorage.removeItem("search-history")),this.addButton("storage","حذف المفضلة",()=>localStorage.removeItem("favorites")),this.addButton("storage","حذف سجل التنقل",()=>localStorage.removeItem("scroll-history")),this.addButton("storage","حذف التنزيلات",()=>{S({type:"cache",action:"delete-all"}),localStorage.removeItem("zad-installed-packs")}),this.addButton("storage","إدارة التنزيلات",()=>router.go("download.html"))}addTimingSection(){this.addInput("timing","تصحيح التاريخ",{type:"number"},e("adjustDate")),this.addOptions("timing","طريقة الحساب",[{name:"معهد ليفا، قم",value:"0"},{name:"جامعة العلوم الإسلامية، كراتشي",value:"1"},{name:"الجمعية الإسلامية لأمريكا الشمالية",value:"2"},{name:"رابطة العالم الإسلامي",value:"3"},{name:"جامعة أم القرى، مكة المكرمة",value:"4"},{name:"الهيئة المصرية العامة للمساحة",value:"5"},{name:"معهد الجيوفيزياء، جامعة طهران",value:"7"},{name:"منطقة الخليج",value:"8"},{name:"الكويت",value:"9"},{name:"قطر",value:"10"},{name:"مجلس أوغاما الإسلامي سنغافورة، سنغافورة",value:"11"},{name:"الاتحاد المنظمات الإسلامية في فرنسا",value:"12"},{name:"رئاسة الشؤون الدينية، تركيا",value:"13"},{name:"الإدارة الروحية لمسلمي روسيا",value:"14"},{name:"لجنة رؤية الهلال العالمية",value:"15"},{name:"دبي",value:"16"},{name:"إدارة التنمية الإسلامية الماليزية (جاكيم)",value:"17"},{name:"تونس",value:"18"},{name:"الجزائر",value:"19"},{name:"وزارة الشؤون الدينية بجمهورية إندونيسيا (كيمناج)",value:"20"},{name:"المغرب",value:"21"},{name:"الجماعة الإسلامية في لشبونة",value:"22"},{name:"وزارة الأوقاف والشؤون والمقدسات الإسلامية، الأردن",value:"23"}],e("method")),this.addOptions("timing","الشفق",[{name:"عام",value:"general"},{name:"أحمر",value:"ahmar"},{name:"أبيض",value:"abyad"}],e("safaq")),this.addOptions("timing","وضع منتصف الليل",[{name:"قياسي (من منتصف الغروب إلى الشروق)",value:"0"},{name:"جعفري (من منتصف الغروب إلى الفجر)",value:"1"}],e("midnightMode")),this.addOptions("timing","طريقة ضبط خط العرض",[{name:"منتصف الليل",value:"1"},{name:"سبع الليل",value:"2"},{name:"بناءً على الزاوية",value:"3"}],e("latitudeAdjust"));function e(t){return{getter:d(()=>settings.timings[t],"getter"),setter(n){settings.timings[t]=n,settings.overwritten.timings[t]=n},reset(){settings.timings[t]=g.timings[t],delete settings.overwritten.timings[t],r()}}}d(e,"handlerFor")}addHeader(e,t){this.refs[`section-${e}`][0].append(o("div",".header",t))}addInput(e,t,n,i){const a=o("input",".unit-input",{attrs:n,value:String(i.getter()),events:{input(){i.setter(a.value)},change:d(()=>r(),"change")}}),l=o("div",".unit",o("span",".unit-name",t),a,o("button",".unit-reset","اعادة التعيين",{events:{click:d(()=>{i.reset(),a.value=i.getter(),r()},"click")}}));this.refs[`section-${e}`][0].append(l)}addSlider(e,t,n,i){const a=o("input",".unit-slider",{type:"range",attrs:n,value:String(i.getter()),events:{input(){i.setter(a.valueAsNumber)},change:d(()=>r(),"change")}}),l=o("div",".unit",o("span",".unit-name",t),a,o("button",".unit-reset","اعادة التعيين",{events:{click:d(()=>{i.reset(),a.value=String(i.getter()),r()},"click")}}));this.refs[`section-${e}`][0].append(l)}addOptions(e,t,n,i){const a=o("select",".unit-select",n.map(({name:v,value:p})=>o("option",{value:p},v)),{events:{change:d(()=>{i.setter(a.value),r()},"change")}},{value:i.getter()}),l=o("div",".unit",o("span",".unit-name",t),a);this.refs[`section-${e}`][0].append(l)}addButton(e,t,n){this.refs[`section-${e}`][0].append(o("div",".unit",".unit-button",t,{events:{click:d(()=>n(),"click")}}))}adjustFont(){const e=!this.get("showFontAdjust"),t=settings.style.core.animationSpeed,n=this.refs["adjust-font"][0];if(this.set("showFontAdjust",e),!t)return n.classList.toggle("hide",!e);n.classList.remove("hide"),n.animate({opacity:e?[0,1]:[1,0]},{duration:400*t}).finished.then(()=>{e||n.classList.add("hide")})}updateFont(e){settings.style.core.fontSize=e,settings.overwritten.style.core.fontSize=e,this.set("fontSize",e),m(!0)}saveSettings(){r()}}y.add("settings",w);
