var re=Object.defineProperty;var u=(e,n)=>re(e,"name",{value:n,configurable:!0});var x=class extends Error{constructor(n){super(),this.name="toml",this.message=n}};u(x,"TOMLError");var s=u((e,n,r)=>{var t=0,i=0,f=0,l=n.split(`
`).map(a=>a.length);for(let a=0;a<l.length;a++){if(f+l[a]>=r)throw t=a+1,i=r-f+1,new x(`${e} at ${t}:${i}`);f+=l[a]+1}},"throwAtIndex");var N=/^[a-zA-Z0-9_-]+$/g,Z=/^(?:(?:[+-]?(?:0|[1-9](?:_?[0-9]+)*))|0(?:[box][0-9a-fA-F](?:_?[0-9a-fA-F]+)*))$/g,F=/^[+-]?(?:0|[1-9](?:_?[0-9]+)*)(?:\.[0-9](?:_?[0-9]+)*)?(?:[eE][-+]?[0-9](?:_?[0-9]+)*)?$/g,L=/"(?:\\\\|\\"|[^"])*"/g,T=/"""(?:\\\\|\\"|[^"]|"(?!""))*"{3,}/g,I=/'''(?:[^']|'(?!''))*'{3,}/g,K=/[0-9+-]/,B=/[0-9A-Fa-f:_.ZTxo+-]+/g;var b=Symbol(`
`),k=Symbol("eq"),Q=Symbol("."),R=Symbol(","),X=Symbol("{"),z=Symbol("}"),w=Symbol("["),O=Symbol("]"),y=Symbol("string"),S=Symbol("bare key"),D=Symbol("int/float/date"),j=/[a-zA-Z0-9_-]+/g,U=u(e=>{for(var n=[],r=e.length,t=0;t!==r;){var i=e[t];if(i===" "||i==="	"){for(t++;e[t]===" "||e[t]==="	";)t++;continue}else if(i===`
`)n.push({type:b,ind:t})&&(t+=1);else if(i==="\r")n.push({type:b,ind:t})&&(t+=2);else if(i==="=")n.push({type:k,ind:t})&&(t+=1);else if(i===".")n.push({type:Q,ind:t})&&(t+=1);else if(i===",")n.push({type:R,ind:t})&&(t+=1);else if(i==="{")n.push({type:X,ind:t})&&(t+=1);else if(i==="}")n.push({type:z,ind:t})&&(t+=1);else if(i==="[")n.push({type:w,ind:t})&&(t+=1);else if(i==="]")n.push({type:O,ind:t})&&(t+=1);else if(i==="#"){if(t=e.indexOf(`
`,t)+1,t===0)break;n.push({type:b,ind:t-1});continue}else if(i.match(K)){let f=t;B.lastIndex=t;let l=B.exec(e)[0];t=B.lastIndex,n.push({type:D,val:l,ind:f})}else if(i.match(j)){let f=t;j.lastIndex=t;let l=j.exec(e)[0];t=j.lastIndex,n.push({type:S,val:l,ind:f})}else if(i==='"'){let f="",l=t;e[t+1]==='"'&&e[t+2]==='"'?(T.lastIndex=t,f=T.exec(e)?.[0],f===void 0&&s("unclosed quote",e,t),t=T.lastIndex,n.push({type:y,basic:!0,triple:!0,str:f.slice(3,-3),ind:l})):(L.lastIndex=t,f=L.exec(e)?.[0],f===void 0&&s("unclosed quote",e,t),t=L.lastIndex,n.push({type:y,basic:!0,triple:!1,str:f.slice(1,-1),ind:l}));continue}else if(i==="'"){let f="",l=0,a=t;e[t+1]==="'"&&e[t+2]==="'"?(I.lastIndex=t,f=I.exec(e)?.[0],f===void 0&&s("unclosed quote",e,t),t=I.lastIndex,n.push({type:y,basic:!1,triple:!0,str:f.slice(3,-3),ind:a})):(l=e.indexOf("'",t+1),f=e.slice(t,l+1),l===-1&&s("unclosed quote",e,t),t=l+1,n.push({type:y,basic:!1,triple:!1,str:f.slice(1,-1),ind:a}));continue}else s(`unexpected token (${i})`,e,t)}return n},"tokenizer");var A=u((e,n)=>{if(typeof e!="string")throw new TypeError(`toml: ${n} of type (${e?.constructor?.name}), expected (String)`)},"checkstr"),W=u((e,n)=>{if(typeof e!="object"||e===null||e instanceof Date||Array.isArray(e))throw new TypeError(`toml: ${n} of type (${e?.constructor?.name}), expected (object)`)},"checkobj");var v=u((e,n,r,t)=>{throw new x(`${e} at key (${n.concat(r.slice(0,t+1)).join(".")})`)},"throwAtKey"),G=u(e=>{A(e,"data");for(var n=U(e),r={},t=0,i=r,f=new Map,l=new Map,a=!1,o=[];t!==n.length;){var p=n[t];if(p.type===b)a=!1,t++;else if(a)s(`unexpected token (${e[p.ind]}), expected new line`,e,p.ind);else if(p.type===w){let c=!1;n[t+1].type===w&&(c=!0);let d=[],h=t+(c?2:1);for(;n[h]?.type!==O;)n[h]===void 0&&s("end of file, expected ']'",e,e.length),d.push(n[h]),h++;let g=H(d,e,n[t+1].ind);c?(i=ie(r,g,f,l,e,n[t].ind),t=h+2):(i=P(r,g,f,l,[]),t=h+1),o=g,a=!0}else t=Y(i,n,t,e,f,l,o),a=!0}return r},"decode"),H=u((e,n,r)=>(e.length===0&&s("empty keys",n,r),e.length&1||s(`keys of length (${e.length})`,n,r),e.map((t,i)=>{if(i&1)return t.type!==Q&&s(`unexpected token (${n[t.ind]}), expected dot`,n,t.ind),!1;if(t.type===S)return t.val;if(t.type===D)return t.val.split(".").map(f=>{if(f.match(N))return f;s(`token (${f}) unable to be bare key`,n,t.ind)});if(t.type===y)return C(t,n);s(`unexpected token (${n[t.ind]})`,n,t.ind)}).filter(t=>t!==!1).flat()),"handleKeys"),P=u((e,n,r,t,i,f=!1)=>{var l=e,a=e;for(let o=0;o<n.length;o++){let p=n[o];a=l,l=l[p],Array.isArray(l)?t.get(l)?(i.length!==0&&v("can not access table array outside headers",i,n,o),l=l[l.length-1]):v("can not access array",i,n,o):typeof l=="object"?r.get(l)&&!f&&v("can not access inlined table",i,n,o):l===void 0?(l={},a[p]=l,r.set(l,!1)):v("can not set defined value",i,n,o)}return l},"handleTable"),ie=u((e,n,r,t,i,f)=>{n=n.concat();var l=n.pop(),a=P(e,n,r,t,[]),o=a[l];Array.isArray(o)?t.get(o)||v("array is not table array",[],n.concat(l),n.length):o===void 0?(o=[],a[l]=o,t.set(o,!0)):v("can not set defined value",[],n.concat(l),n.length);var p={};return r.set(p,!1),o.push(p),p},"handleTableArray"),J=u((e,n,r,t,i,f,l,a)=>{var o=e.type,p;if(o===y)p=C(e,t);else if(o===S){let c=e.val;c==="true"?p=!0:c==="false"?p=!1:c==="nan"?p=NaN:c==="inf"?p=1/0:s(`unexpected token (${c})`,t,e.ind)}else if(o===D){let c=e.val;if(c==="+"||c==="-"){let d=n[r+1];d.type===S?(r++,d.val==="nan"?p=NaN:d.val==="inf"?p=c==="+"?1/0:-1/0:s(`unexpected token (${c})`,t,e.ind)):s(`unexpected token (${c})`,t,e.ind)}else c.match(Z)?(p=Number(c.replaceAll("_","")),Object.is(p,NaN)&&s(`mulformed integer (${c})`,t,e.ind),Number.isSafeInteger(p)||((p>9223372036854776e3||p<-9223372036854776e3)&&s(`(${c}) is not 64bit int`,t,e.ind),p=BigInt(c))):c.match(F)?(p=Number(c.replaceAll("_","")),Object.is(p,NaN)&&s(`mulformed float (${c})`,t,e.ind)):(p=new Date(c),Object.is(p.getSeconds(),NaN)&&s(`unexpected token (${c})`,t,e.ind))}else o===w?[p,r]=fe(n,r,t,i,f,l,a):o===X?[p,r]=le(n,r,t,i,f,l,a):s(`unexpected token (${t[e.ind]})`,t,e.ind);return[p,r]},"handleValue"),Y=u((e,n,r,t,i,f,l,a)=>{for(var o=[],p;n[r]?.type!==k;)n[r]===void 0&&s("end of file, expected '='",t,t.length),o.push(n[r]),r++;var c=H(o,t,n[r].ind),d=c.pop(),h=c.length?P(e,c,i,f,l,a):e;return r++,[p,r]=J(n[r],n,r,t,c.concat(d),i,f,l),h[d]===void 0?h[d]=p:v("can not set defined value",l,c.concat(d),1e5),r+1},"handleKeyValue"),le=u((e,n,r,t,i,f,l)=>{var a={};i.set(a,!0),t=l.concat(t),n++;for(var o=e[n],p=!1,c=!0;o?.type!==z;)c=!1,o===void 0?s("end of file, expected '}'",r,r.length):o.type===b?s("unexpected new line",r,o.ind):o.type===R?(p?p=!1:s("unexpected token (,)",r,o.ind),n++):(p=!0,n=Y(a,e,n,r,i,f,t,!0)),o=e[n];return!c&&!p&&s("unexpected trailing comma",r,e[n-1].ind),[a,n]},"handleInlinedTable"),fe=u((e,n,r,t,i,f,l)=>{var a=[];f.set(a,!1),t=l.concat(t),n++;for(var o=e[n],p=!1,c;o?.type!==O;)o===void 0?s("end of file, expected ']'",r,r.length):o.type===b||(o.type===R?p?p=!1:s("unexpected token (,)",r,o.ind):(p&&s(`unexpected token (${r[o.ind]}), expected ','`,r,o.ind),[c,n]=J(o,e,n,r,a.length,i,f,t),a.push(c),p=!0)),n++,o=e[n];return[a,n]},"handleArray"),C=u((e,n)=>{var{basic:r,triple:t,str:i}=e;return t&&(i[0]===`
`&&(i=i.slice(1)),i.startsWith(`\r
`)&&(i=i.slice(2))),!t&&i.includes(`
`)&&s("single quote contains new line",n,e.ind),r&&(i=i.replaceAll("\\b","\b").replaceAll("\\t","	").replaceAll("\\n",`
`).replaceAll("\\f","\f").replaceAll("\\r","\r").replaceAll('\\"','"').replaceAll("\\\\","#\\#").replaceAll(/\\U......../g,f=>String.fromCodePoint(Number.parseInt(f.slice(2),16))).replaceAll(/\\u..../g,f=>String.fromCodePoint(Number.parseInt(f.slice(2),16))).replaceAll(/\\\s*?\n\s*/g,"").replaceAll("#\\#","\\")),i},"handleString");var q=u((e,n={})=>{W(e,"data"),n={forceInline:!1,ident:"	",newLine:`
`,whitespace:" ",compactArray:!1,allBasicString:!1,multilineString:!1,...n},A(n.newLine,"newLine"),A(n.whitespace,"whitespace"),A(n.ident,"ident");var r=[""];return M(e,[],!1,r,n),r[0]},"encode");q.compact=(e,n)=>q(e,{forceInline:!0,ident:"",newLine:`
`,whitespace:"",compactArray:!0,...n});var ee=u(e=>typeof e=="object"&&e!==null&&!(e instanceof Date),"isObject"),M=u((e,n,r,t,i)=>{var{forceInline:f,ident:l,newLine:a,whitespace:o}=i,p="",c=[],d=!0,h=n.length===0?0:1;l=n.length===0?"":l,r&&(p+=`[[${n.join(".")}]]`+a,d=!1);for(let g in e){let m=e[g];if(!f&&ee(m)&&(!Array.isArray(m)||m.length>0&&m.every(ee))){c.push(g);continue}let $=E(m,h+1,i);$!==void 0&&(d&&(d=!1,n.length!==0&&(p+=`[${n.join(".")}]`+a)),p+=l+_(g,i)+o+"="+o+$+a)}p&&(t[0]+=(t[0]?a:"")+p),c.forEach(g=>{var m=e[g];Array.isArray(m)?m.forEach($=>{n.push(_(g,i)),M($,n,!0,t,i)}):(n.push(_(g,i)),M(m,n,!1,t,i))}),n.pop()},"handleTable"),E=u((e,n,r)=>{if(e===!0)return"true";if(e===!1)return"false";if(typeof e=="string")return ne(e,r);if(Object.is(e,NaN))return"nan";if(Object.is(e,1/0))return"inf";if(Object.is(e,-1/0))return"-inf";if(typeof e=="number"||typeof e=="bigint"&&e<9223372036854776e3&&e>-9223372036854776e3)return String(e);if(e instanceof Date)return e.toISOString();if(Array.isArray(e)){let{compactArray:t,ident:i,whitespace:f,newLine:l}=r;if(e.length===0)return"[]";let a=i.repeat(n);return t?"["+e.map(o=>E(o,n+1,r)).filter(Boolean).join(","+f)+"]":"["+l+a+e.map(o=>E(o,n+1,r)).filter(Boolean).join(","+l+a)+l+i.repeat(n-1)+"]"}if(typeof e=="object"&&e!==null){let{whitespace:t,newLine:i}=r;return"{"+Object.keys(e).map(f=>{var l=E(e[f],n,r);if(l)return _(f,r)+t+"="+t+l}).filter(Boolean).join(","+t)+"}"}},"handleValue"),te=u((e,n)=>(e=e.replaceAll("\\","#\\#"),n&&(e=e.replaceAll(`
`,"\\n")),e.replaceAll("\b","\\b").replaceAll("	","\\t").replaceAll("\f","\\f").replaceAll("\r","\\r").replaceAll('"','"').replaceAll("#\\#","\\")),"escapeString"),ne=u((e,n,r=!1)=>e.includes(`
`)&&!r&&n.multilineString?n.allBasicString||e.match(/\t|\f|\r|\"|\\/g)?`"""
`+te(e,n,!1)+'"""':`'''
`+e+"'''":n.allBasicString||e.match(/\n|\t|\f|\r|\"|\\/g)?'"'+te(e,n)+'"':"'"+e+"'","handleString"),_=u((e,n)=>e.match(N)?e:ne(e,n,!0),"handleKey");var V={decode:G,encode:q,TOMLError:x};globalThis.$toml=V;var De=V;export{x as TOMLError,G as decode,De as default,q as encode};
